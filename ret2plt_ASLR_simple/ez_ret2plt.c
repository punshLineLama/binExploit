#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// gcc -fno-stack-protector -no-pie -o vuln ez_ret2plt.c

/* Eventhough shell() function isnt invoked directly, its needed here since 'system@PLT' and 'exit@PLT' stub code should be present in executable to successfully exploit it. */
void shell() {
 system("/bin/sh");
 exit(0);
}

int main(int argc, char* argv[]) {
 int i=0;
 char buf[256];
 printf("Enter the string of destiny: \n");
 fgets(buf, 350, stdin);
 printf("%s\n",buf);
 return 0;
}